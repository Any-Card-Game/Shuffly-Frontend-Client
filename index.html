<html><head><title>Spoke</title><script type="text/javascript" src="http://sync3.frozenmountain.com/client.js?v=3.4.2"></script>

<script type="text/javascript">
    var client = fm.websync.client; // shortcut
    var util = fm.utilities;        // shortcut
    
    client.initialize({
        key: '035d9877-9eaf-45ef-936f-80087fb3a221' // your *public* key
    });
    
    client.connect({
        onSuccess: function(args) { // optional
            util.log('Connected!');
        },
        onFailure: function(args) { // optional
            util.log('Connect failed: ' + args.error);
        }
    });

    client.subscribe({
        channel: '/consolepublisher',
        onSuccess: function(args) { // optional
            util.log('Subscribed!');
        },
        onFailure: function(args) { // optional
            util.log('Subscribe failed: ' + args.error);
        },
        onReceive: function(args) {
   
            util.log('Received data: ' +JSON.stringify(args.data));
          
        }
    });    
    

    
    function joinGame() {
        client.subscribe({
        channel: '/consolepublisher/'+document.getElementById('name').value,
        onSuccess: function(args) { // optional
            util.log('Subscribed!');
        },
        onFailure: function(args) { // optional
            util.log('Subscribe failed: ' + args.error);
        },
        onReceive: function(args) {
          if(args.data.Question){
            util.log('Question: ' + args.data.Question);
            for(i=0;i<args.data.Answers.length;i++)
              {
                util.log("<a href='javascript:answerQuestion("+i+")' >"+args.data.Answers[i]+"</a>");
              }
          }
          else{
            util.log('Received data: ' + JSON.stringify(args.data));
          }
        }
    });
    
    
        client.publish({
            channel: '/consolepublisher',
            data: {
                Type: 0,
                PlayerName:document.getElementById('name').value
            },
            onSuccess: function(args) { // optional
                util.log('Published!');
            },
            onFailure: function(args) { // optional
                util.log('Publish failed: ' + args.error);
            }
        });
    }    
    function answerQuestion(id) {
        client.publish({
            channel: '/consolepublisher',
            data: {
                Type: 1,
                AnswerIndex:id
            },
            onSuccess: function(args) { // optional
                util.log('Published!');
            },
            onFailure: function(args) { // optional
                util.log('Publish failed: ' + args.error);
            }
        });
    }
</script> 
</head><body>

Name: <input type="text" id="name" /> <br />
<button onclick="joinGame(); return false;">Join Game</button>
<br />
<input type="text" id="text" /> <button onclick="answerQuestion(); return false;">Answer Question</button>
</body></html>